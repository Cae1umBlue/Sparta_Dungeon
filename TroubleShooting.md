# 🎮 Unity 트러블슈팅 : 인벤토리 Input Action 충돌 문제

## 1. 배경

플레이맵에 존재하는 아이템을 보관·사용하기 위해 인벤토리 시스템을 구현했다.  
플레이어는 상호작용 키(E)를 눌러 아이템을 인벤토리에 저장한 뒤, **사용** 또는 **버리기** 버튼을 통해 아이템을 사용할 수 있다.  
본 프로젝트에서는 **Unity Input Action** 시스템을 사용하여 입력을 처리하고 있다.

## 2. 발단

인벤토리 창을 활성화할 때, `bool canLook`, `Cursor.lockState`를 활용해 마우스를 표시하고 시선 이동을 멈추도록 설정했다.  
Tab 키로 인벤토리를 열면, 마우스 커서가 나타나고 화면 회전이 멈추는 기능은 정상 작동했다.  
그러나 **WASD 이동**과 **Spacebar 점프**는 여전히 동작하는 문제가 있었다.

## 3. 문제 상황

아이템을 클릭하면 하단에 아이템 정보창이 뜨고, **사용하기 / 버리기** 버튼으로 해당 동작을 수행하게 만들었다.  
하지만 인벤토리 창이 열린 상태에서도 **WASD**나 **Spacebar** 입력이 들어오면:  

- 캐릭터가 이동하거나 점프하고,  
- 동시에 아이템 선택창의 포커스가 바뀌거나,  
- 원치 않게 아이템이 사용/버려지는 현상이 발생했다.  

즉, **플레이어 이동 입력과 UI 입력이 동시에 처리**되는 충돌이 있었다.

## 4. 원인 분석

코드 자체에는 기능별로 로직이 잘 나눠져 있었기 때문에, 버그라기보다는 **입력 신호 관리 문제**라고 판단했다.  
즉, 인벤토리 창 활성화 시에도 이동·점프 입력이 여전히 처리되고 있었던 것이다.

## 5. 해결 시도

튜터님의 조언을 받아 시도해볼만한 방법은 다음과 같다.

1. **인벤토리 창 활성화 시** 플레이어의 이동·점프 입력을 받지 않거나 무시하는 로직 추가  
2. **UI 버튼 인스펙터**에서 `Navigation`을 `None`으로 설정하여 클릭 외 입력을 차단

## 6. 결과

임시로 **버튼 `Navigation`을 `None`**으로 설정하여 WASD, Spacebar 입력이 UI에 영향을 주는 문제를 막았다.  
그 결과 아이템이 의도치 않게 사용/버려지는 문제는 해결되었으나, **아이템 선택창 포커스가 키 입력에 따라 이동하는 현상**은 여전히 남아있다.

## 7. 추후 계획

차후에는 인벤토리 활성화 상태에서 **이동·점프 Input Action 자체를 비활성화**하는 로직을 추가하여, 모든 UI 포커스 이동 및 캐릭터 이동을 완전히 차단할 예정이다.

## 8. 추가 시도

### 시도 결과

```csharp
EventSystem.current.sendNavigationEvents = false;
```
- EventSystem에서 UI 키보드 네비게이션 기능을 비활성화했다.

- 그 결과, WASD·방향키 입력이 UI 포커스에 영향을 주지 않게 되었다.

### 적용 배경

- 구현 목표가 Rust 스타일 인벤토리처럼 마우스로만 UI를 조작하는 방식이었다.
- 키보드 네비게이션이 필요 없는 구조이므로 해당 방법을 사용해도 문제가 없다.

### 장점

- 간단한 한 줄 코드로 모든 UI에서 키보드 네비게이션을 즉시 차단할 수 있다.
- Player 입력(WASD, 마우스 등)과 UI 포커스 이동 충돌 문제를 해결할 수 있다.

### 한계

- 전역적으로 UI 키보드 네비게이션이 꺼지는 기능이다.
- 키보드로 UI를 조작해야 하는 상황(예: 옵션 메뉴, 캐릭터 선택 화면 등)에서는 부적합하다.

### 배운 점

- 특정 상황(인벤토리·HUD)에서는 간단하고 효과적인 해결책이 될 수 있지만,
- 키보드 네비게이션이 필요한 UI가 존재한다면 다른 방법을 고민해봐야할것같다.
